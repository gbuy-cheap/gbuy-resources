import{createRulesFromRequest}from"./createRulesFromRequest.js";import{resetSessionRules}from"./resetSessionRules.js";import{removeXSasString}from"./removeXSasString.js";import{makeFetch}from"./makeFetch.js";import{sassUserAgent,userAgent}from"../../../../constants/userAgent.js";const sendServerRequest=async(e,s)=>{await createRulesFromRequest(e);var t=e.input,a=t.match(/https:\/\/www.amazon.+\/address-change.+sasRequestId=\d+/),r=t.match(/https:\/\/www.amazon.+ssas.+=.+sass.+/),n=t.match(/https:\/\/www.amazon.+\/amazonprime$/),m=t.match(/https:\/\/sellercentral\.amazon.+\/rcpublic\/productmatch\?searchKey=/);t.match(/https:\/\/www.amazon.+\/gp\/css\/homepage.html$/)&&(userAgent.value=e.init.headers.UserAgent),m&&(sassUserAgent.value=e.init.headers["User-Agent"],await resetSessionRules()),r&&(t=e.init.headers,e.init.headers=removeXSasString(t)),makeFetch({request:e,isGettingSessionMask:n,isAddressChangeMask:a,sendResponse:s})};export{sendServerRequest};