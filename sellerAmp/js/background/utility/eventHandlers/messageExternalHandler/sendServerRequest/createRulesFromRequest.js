"use strict";import{ruleNameIDs}from"../../../../constants/ruleNameIDs.js";import{headerOperation}from"../../../../constants/declarativeNetRequestConstants.js";import{netRequestAPI}from"../../../netRequestAPI.js";import{generateRuleId}from"../../../generateRuleId.js";import{userAgentRuleIndex}from"../../../../constants/userAgentRuleIndex.js";import{originRuleIndex}from"../../../../constants/originRuleIndex.js";const createRulesFromRequest=async e=>{var t=e.input;t.match(/https:\/\/www.amazon.+ssas.+=.+sass.+/)&&(e=e.init.headers?.origin,await addOrigin(e,t))},addOrigin=async(e,t)=>{originRuleIndex.value=originRuleIndex.value+1;var r=originRuleIndex.value,r=generateRuleId(ruleNameIDs.setSassOrigin,r),e=[{operation:headerOperation.SET,header:"origin",value:e}];await netRequestAPI.updateRequestHeaders({id:r,requestHeaders:e,urlFilter:t})};export{createRulesFromRequest};