"use strict";import{COMMAND_COMMAND_EXISTS,COMMAND_EXTENSION_INSTALLED,COMMAND_SHOW_SAS_EXT,SUPPORTED_COMMANDS}from"../../../constants/supportedCommands.js";import{sendServerRequest}from"./sendServerRequest/sendServerRequest.js";import{sentrySellerAmp}from"../../../../content/sentrySellerAmp/sentrySellerAmp.js";const messageExternalHandler=async(e,s,t)=>{sentrySellerAmp.wrap(function(){handleEvent(e,s,t)})},handleEvent=async(s,t,n)=>{if(s.command==COMMAND_COMMAND_EXISTS)n({result:SUPPORTED_COMMANDS.includes(s.command_name),command_name:s.command_name});else if(s.command==COMMAND_SHOW_SAS_EXT)chrome.tabs.query({active:!0,currentWindow:!0},function(e){chrome.tabs.sendMessage(t.tab.id,s,function(e){n(e)})});else{var e;if(s.type!==COMMAND_EXTENSION_INSTALLED)return e=s.input.match(/https:\/\/www.amazon.+gp\/aw\/c.+ssas.+=.+sass.+sasRequestId=\d+/),s.input.match(/https:\/\/data.amazon.+\/api\/marketplaces\/.+\/cart\/carts\/retail\/items/)||e?setTimeout(()=>sendServerRequest(s,n),1e3):await sendServerRequest(s,n),!0;n({result:!0,command_name:s.command_name})}};export{messageExternalHandler};